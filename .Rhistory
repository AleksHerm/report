to_table(report(x))
to_fulltable(report(x))
report(x, levels_percentage=TRUE, missing_percentage=TRUE)
x <- factor(rep(c("A", "B", "C"), 10))
r$table
x <- factor(rep(c("A", "B", "C"), 10))
r <- report(factor(rep(c("A", "B", "C"), 10)))
library(report)
r <- report(factor(rep(c("A", "B", "C"), 10)))
testthat::expect_equal(r$table, 0.5, tol = 0)
r <- report(factor(rep(c("A", "B", "C"), 10)))
r$table
testthat::expect_equal(nrow(r$table), 3, tol = 0)
testthat::expect_null(r$table$Median)
r$table$Median
testthat::expect_warning(r$table$Median)
r <- report(factor(rep(c("A", "B", "C"), 10)), levels_percentage=TRUE, missing_percentage=TRUE)
r$table
r$table$perc_Missing
testthat::expect_equal(r$table$perc_Missing, c(0, 0, 0), tol = 0)
x <- factor(rep(c("A", "B", "C"), 10))
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by(Level) %>%
summarise(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
library(dplyr)
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by(Level) %>%
summarise(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
"
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by("Level") %>%
summarise(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
table_full
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by(!!"Level") %>%
summarise_(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by(!!enquo("Level")) %>%
summarise_(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by(!!enquo(sym("Level"))) %>%
summarise_(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
sym("Level")
enquo(sym("Level"))
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by(!!quo(sym("Level"))) %>%
summarise_(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
enquo(sym("Level"))
enquo(sym(c("Level"))))
enquo(sym(c("Level")))
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by_("Level") %>%
summarise_(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by_("Level") %>%
summarise(n_Obs = n(),
perc_Obs = n() / length(x),
n_Missing = sum(is.na(x)),
perc_Missing = n_Missing / n_Obs)
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by_("Level") %>%
summarise_("n_Obs = n()",
"perc_Obs = n() / length(x)",
"n_Missing = sum(is.na(x))",
"perc_Missing = n_Missing / n_Obs")
data.frame(Level = x) %>%
group_by_("Level") %>%
summarise_("n_Obs = n()")
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by_("Level") %>%
summarise_("n_Obs" = n(),
"perc_Obs" = n() / length(x),
"n_Missing" = sum(is.na(x)),
"perc_Missing" = "n_Missing" / "n_Obs")
# Table -------------------------------------------------------------------
table_full <- data.frame(Level = x) %>%
group_by_("Level") %>%
summarise_("n_Obs" = "n()",
"perc_Obs" = "n() / length(x)",
"n_Missing" = "sum(is.na(x))",
"perc_Missing" = "n_Missing / n_Obs")
table_full
x <- rep(c("A", "B", "C"), 10)
x <- rep(c("A", "B", "C"), 10)
# Table -------------------------------------------------------------------
sort(table(x), decreasing=TRUE)
x <- c("A", "B", "C", "A", "B", "B", "D")
# Table -------------------------------------------------------------------
sort(table(x), decreasing=TRUE)
# Table -------------------------------------------------------------------
byfreq <- sort(table(x), decreasing=TRUE)
table_full <- data.frame(Level = x) %>%
group_by_("Level") %>%
summarise_("n_Obs" = "n()",
"perc_Obs" = "n() / length(x)",
"n_Missing" = "sum(is.na(x))",
"perc_Missing" = "n_Missing / n_Obs")
# Table -------------------------------------------------------------------
byfreq <- sort(table(x), decreasing=TRUE)
byfreq
library(dplyr)
library(report)
library(dplyr)
n_characters = 4
x <- c("A", "B", "C", "A", "B", "B", "D", "E", "B", "D", "A")
levels_percentage = TRUE
missing_percentage = FALSE
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all"){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(table_full) > 1){
text <- paste0(nrow(table_full), " entries: ", text)
} else {
text <- paste0(nrow(table_full), " entry: ", text)
}
text_full <- text
if(missing_percentage == TRUE){
text_full <- paste0(text_full, text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(any(table_full$n_Missing > 0)){
text <- paste0(text, "; ", text_perc_Missing, ")")
} else{
text <- paste0(text, ")")
}
} else{
text_full <- paste0(text_full, text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Obs"))
if(any(table_full$n_Missing > 0)){
text <- paste0(text, "; ", text_n_Missing, ")")
} else{
text <- paste0(text, ")")
}
}
table_full$perc_Missing
table_full
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
table_full
table_full <- data.frame(
n_Obs = length(x),
n_Missing = sum(is.na(x)),
n_Entries = nrow(n_char)
)
table_full
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
if(missing_percentage == TRUE){
text_full <- paste0(text_full, text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_perc_Missing, ")")
} else{
text <- paste0(text, ")")
}
} else{
text_full <- paste0(text_full, text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Obs"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_n_Missing, ")")
} else{
text <- paste0(text, ")")
}
}
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
if(missing_percentage == TRUE){
text_full <- paste0(text_full, text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_perc_Missing, ")")
} else{
text <- paste0(text, ")")
}
} else{
text_full <- paste0(text_full, text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_n_Missing, ")")
} else{
text <- paste0(text, ")")
}
}
text
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all"){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(table_full) > 1){
text <- paste0(nrow(table_full), " entries: ", text)
} else {
text <- paste0(nrow(table_full), " entry: ", text)
}
text_full <- text
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
if(missing_percentage == TRUE){
text_full <- paste0(text_full, text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_perc_Missing, ")")
} else{
text <- paste0(text, ")")
}
} else{
text_full <- paste0(text_full, text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_n_Missing, ")")
} else{
text <- paste0(text, ")")
}
}
text
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all"){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(n_char) > 1){
text <- paste0(nrow(n_char), " entries: ", text)
} else {
text <- paste0(nrow(n_char), " entry: ", text)
}
text_full <- text
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
if(missing_percentage == TRUE){
text_full <- paste0(text_full, text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_perc_Missing, ")")
} else{
text <- paste0(text, ")")
}
} else{
text_full <- paste0(text_full, text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, "; ", text_n_Missing, ")")
} else{
text <- paste0(text, ")")
}
}
text
n_characters < nrow(n_char)
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all"){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(n_char) > 1){
text <- paste0(nrow(n_char), " entries: ", text)
} else {
text <- paste0(nrow(n_char), " entry: ", text)
}
text
text <- paste0(text, " and ", nrow(n_char)-n_characters, " others")
text
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all"){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(n_char) > 1){
text <- paste0(nrow(n_char), " entries: ", text)
} else {
text <- paste0(nrow(n_char), " entry: ", text)
}
if(nrow(n_char)-n_characters == 1){
text <- paste0(text, " and ", nrow(n_char)-n_characters, " other")
}
if(nrow(n_char)-n_characters > 1){
text <- paste0(text, " and ", nrow(n_char)-n_characters, " others")
}
text_full <- text
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all" | n_characters > nrow(n_char)){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(n_char) > 1){
text <- paste0(nrow(n_char), " entries: ", text)
} else {
text <- paste0(nrow(n_char), " entry: ", text)
}
if(nrow(n_char)-n_characters == 1){
text <- paste0(text, " and ", nrow(n_char)-n_characters, " other")
}
if(nrow(n_char)-n_characters > 1){
text <- paste0(text, " and ", nrow(n_char)-n_characters, " others")
}
text_full <- text
text_full
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
text_n_Missing
if(missing_percentage == TRUE){
text_full <- paste0(text_full, "(", text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, " (", text_perc_Missing, ")")
} else{
text <- paste0(text, ".")
}
} else{
text_full <- paste0(text_full, "(", text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, " (", text_n_Missing, ")")
} else{
text <- paste0(text, ".")
}
}
text_full
text
n_char <- as.data.frame(sort(table(x), decreasing=TRUE))
names(n_char) <- c("Entry", "n_Entry")
n_char$perc_Entry <- n_char$n_Entry / length(x)
if(n_characters == "all" | n_characters > nrow(n_char)){
n_characters <- nrow(n_char)
}
# Table -------------------------------------------------------------------
table_full <- data.frame(
n_Entries = nrow(n_char),
n_Obs = length(x),
n_Missing = sum(is.na(x))
)
table_full$perc_Missing <- table_full$n_Missing / table_full$n_Obs * 100
table <- table_full
if(levels_percentage == TRUE){
text <- paste0(n_char$Entry, ", ", format_value(n_char$perc_Entry), "%")
} else{
text <- paste0(n_char$Entry, ", n = ", n_char$n_Entry)
}
text <- text[1:n_characters]
text <- paste0(text, collapse = "; ")
if(nrow(n_char) > 1){
text <- paste0(nrow(n_char), " entries: ", text)
} else {
text <- paste0(nrow(n_char), " entry: ", text)
}
if(nrow(n_char)-n_characters == 1){
text <- paste0(text, " and ", nrow(n_char)-n_characters, " other")
}
if(nrow(n_char)-n_characters > 1){
text <- paste0(text, " and ", nrow(n_char)-n_characters, " others")
}
text_full <- text
text_n_Missing <- paste0(table_full$n_Missing[1], " missing")
text_perc_Missing <- paste0(format_value(table_full$perc_Missing[1]), "% missing")
if(missing_percentage == TRUE){
text_full <- paste0(text_full, "(", text_perc_Missing, ")")
table <- dplyr::select(table, -one_of("n_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, " (", text_perc_Missing, ")")
}
} else{
text_full <- paste0(text_full, " (", text_n_Missing, ")")
table <- dplyr::select(table, -one_of("perc_Missing"))
if(table_full$n_Missing[1] > 0){
text <- paste0(text, " (", text_n_Missing, ")")
}
}
out <- list(
text = text,
text_full = text_full,
table = table,
table_full = table_full
)
out
