#' Collapse Character Vector
#'
#' @param x Character vector.
#' @param sep Separator.
#' @param last Last separator.
#'
#' @author \href{https://dominiquemakowski.github.io/}{Dominique Makowski}
#'
#' @examples
#' format_text_collapse(c("A", "B", "C"))
#' @importFrom utils head tail
#'
#' @export
format_text_collapse <- function(x, sep = ", ", last = " and ") {
  if (length(x) == 1) {
    return(x)
  } else {
    s <- paste0(head(x, -1), collapse = sep)
    s <- paste0(c(s, tail(x, 1)), collapse = last)
    return(s)
  }
}


#' Autowrap String
#'
#' @param x Character vector.
#' @param width Positive integer giving the target column for wrapping lines in the output.
#'
#' @author \href{https://dominiquemakowski.github.io/}{Dominique Makowski}
#' @importFrom stringr str_split
#' @export
format_text_wrap <- function(x, width = NULL) {
  text <- stringr::str_split(x, "\n", simplify = TRUE)
  if (is.null(width)) {
    text <- strwrap(text)
  } else {
    text <- strwrap(text, width = width)
  }
  text <- paste0(text, collapse = "\n")
  cat(text)
}
